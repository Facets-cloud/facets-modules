intent: cloud_account
flavor: impersonate
version: '1.0'
clouds:
- gcp
description: Cloud account modules which has impersonation support
spec:
  title: Cloud account modules which has impersonation support
  description: Cloud account modules which has impersonation support
  type: object
  properties:
    project:
      type: string
      description: The project in context to create google cloud resources
      x-ui-placeholder: <project-id>
      x-ui-overrides-only: true
    service_account:
      type: string
      description: The service account to impersonate
      x-ui-placeholder: terraform@<project-id>.iam.gserviceaccount.com
      pattern: ^[a-zA-Z0-9][a-zA-Z0-9-]{4,28}[a-zA-Z0-9]@[a-z][a-z0-9-]{4,28}[a-z0-9]\.iam\.gserviceaccount\.com$
      x-ui-error: Invalid service account format. Please enter a valid service account
      x-ui-overrides-only: true
  required:
  - service_account
  - project
outputs:
  default:
    type: '@outputs/cloud_account'
    providers:
      google-beta:
        source: hashicorp/google-beta
        version: 6.23.0
        attributes:
          project: attributes.project
          access_token: attributes.access_token
      google:
        source: hashicorp/google
        version: 6.23.0
        attributes:
          project: attributes.project
          access_token: attributes.access_token
      google5:
        source: hashicorp/google5
        version: 5.32.0
        attributes:
          project: attributes.project
          access_token: attributes.access_token
sample:
  kind: cloud_account
  flavor: impersonate
  version: '1.0'
  disabled: true
  spec:
    project: <project-id>
    service_account: terraform@<project-id>.iam.gserviceaccount.com
